syntax = "proto3";

option go_package = "github.com/xichen2020/eventdb/generated/proto/servicepb";

package servicepb;

import "github.com/gogo/protobuf/gogoproto/gogo.proto";

message FieldValue {
  enum Type {
    UNKNOWN = 0;
    NULL = 1;
    BOOL = 2;
    INT = 3;
    DOUBLE = 4;
    STRING = 5;
    TIME = 6;
  }
  Type type = 1;
  bool bool_val = 2;
  int64 int_val = 3;
  double double_val = 4;
  bytes string_val = 5;
  int64 time_nanos_val = 6;
}

message Field {
  repeated string path = 1;
  FieldValue value = 2 [(gogoproto.nullable) = false];
}

message Document {
  bytes id = 1;
  int64 time_nanos = 2;
  bytes raw_data = 3;
  repeated Field fields = 4 [(gogoproto.nullable) = false];
}

message Documents {
  bytes namespace = 1;
  repeated Document docs = 2 [(gogoproto.nullable) = false];
}

// WriteResponse is the response to the Write call.
message WriteResponse {

}

// TODO(xichen): Add query rpc.
service eventdb {
  // Write writes a list of documents.
  rpc Write(Documents) returns (WriteResponse) {}
}
